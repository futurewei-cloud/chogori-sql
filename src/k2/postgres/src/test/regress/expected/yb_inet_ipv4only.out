--
-- INET (IPv4 addresses only)
--
-- prepare the table...
DROP TABLE IF EXISTS INET_TBL;
NOTICE:  table "inet_tbl" does not exist, skipping
CREATE TABLE INET_TBL (c cidr, i inet);
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1', '192.168.1.226/24');
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1.0/26', '192.168.1.226');
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1', '192.168.1.0/24');
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1', '192.168.1.0/25');
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1', '192.168.1.255/24');
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1', '192.168.1.255/25');
INSERT INTO INET_TBL (c, i) VALUES ('10', '10.1.2.3/8');
INSERT INTO INET_TBL (c, i) VALUES ('10.0.0.0', '10.1.2.3/8');
INSERT INTO INET_TBL (c, i) VALUES ('10.1.2.3', '10.1.2.3/32');
INSERT INTO INET_TBL (c, i) VALUES ('10.1.2', '10.1.2.3/24');
INSERT INTO INET_TBL (c, i) VALUES ('10.1', '10.1.2.3/16');
INSERT INTO INET_TBL (c, i) VALUES ('10', '10.1.2.3/8');
INSERT INTO INET_TBL (c, i) VALUES ('10', '11.1.2.3/8');
INSERT INTO INET_TBL (c, i) VALUES ('10', '9.1.2.3/8');
-- check that CIDR rejects invalid input:
INSERT INTO INET_TBL (c, i) VALUES ('192.168.1.2/30', '192.168.1.226');
ERROR:  invalid cidr value: "192.168.1.2/30"
LINE 1: INSERT INTO INET_TBL (c, i) VALUES ('192.168.1.2/30', '192.1...
                                            ^
DETAIL:  Value has bits set to right of mask.
-- check that CIDR rejects invalid input when converting from text:
INSERT INTO INET_TBL (c, i) VALUES (cidr('192.168.1.2/30'), '192.168.1.226');
ERROR:  invalid cidr value: "192.168.1.2/30"
LINE 1: INSERT INTO INET_TBL (c, i) VALUES (cidr('192.168.1.2/30'), ...
                                                 ^
DETAIL:  Value has bits set to right of mask.
SELECT '' AS ten, c AS cidr, i AS inet FROM INET_TBL ORDER BY c, i;
 ten |      cidr      |       inet
-----+----------------+------------------
     | 10/8           | 9/8
     | 10/8           | 10/8
     | 10/8           | 10/8
     | 10/8           | 11/8
     | 10.0.0.0/32    | 10/8
     | 10.1/16        | 10.1/16
     | 10.1.2/24      | 10.1.2/24
     | 10.1.2.3/32    | 10.1.2.3/32
     | 192.168.1/24   | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24
     | 192.168.1/24   | 192.168.1.0/25
     | 192.168.1/24   | 192.168.1.128/25
     | 192.168.1.0/26 | 192.168.1.226/32
(14 rows)

-- now test some support functions
SELECT '' AS ten, i AS inet, host(i), text(i), family(i) FROM INET_TBL ORDER BY c, i;
 ten |       inet       |     host      |       text       | family
-----+------------------+---------------+------------------+--------
     | 9/8              | 9.1.2.3       | 9.1.2.3/32       |      4
     | 10/8             | 10.1.2.3      | 10.1.2.3/32      |      4
     | 10/8             | 10.1.2.3      | 10.1.2.3/32      |      4
     | 11/8             | 11.1.2.3      | 11.1.2.3/32      |      4
     | 10/8             | 10.1.2.3      | 10.1.2.3/32      |      4
     | 10.1/16          | 10.1.2.3      | 10.1.2.3/32      |      4
     | 10.1.2/24        | 10.1.2.3      | 10.1.2.3/32      |      4
     | 10.1.2.3/32      | 10.1.2.3      | 10.1.2.3/32      |      4
     | 192.168.1/24     | 192.168.1.0   | 192.168.1.0/32   |      4
     | 192.168.1/24     | 192.168.1.226 | 192.168.1.226/32 |      4
     | 192.168.1/24     | 192.168.1.255 | 192.168.1.255/32 |      4
     | 192.168.1.0/25   | 192.168.1.0   | 192.168.1.0/32   |      4
     | 192.168.1.128/25 | 192.168.1.255 | 192.168.1.255/32 |      4
     | 192.168.1.226/32 | 192.168.1.226 | 192.168.1.226/32 |      4
(14 rows)

SELECT '' AS ten, c AS cidr, broadcast(c),
  i AS inet, broadcast(i) FROM INET_TBL ORDER BY c, i;
 ten |      cidr      |   broadcast    |       inet       |    broadcast
-----+----------------+----------------+------------------+------------------
     | 10/8           | 10/8           | 9/8              | 9/8
     | 10/8           | 10/8           | 10/8             | 10/8
     | 10/8           | 10/8           | 10/8             | 10/8
     | 10/8           | 10/8           | 11/8             | 11/8
     | 10.0.0.0/32    | 10.0.0.0/32    | 10/8             | 10/8
     | 10.1/16        | 10.1/16        | 10.1/16          | 10.1/16
     | 10.1.2/24      | 10.1.2/24      | 10.1.2/24        | 10.1.2/24
     | 10.1.2.3/32    | 10.1.2.3/32    | 10.1.2.3/32      | 10.1.2.3/32
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1.0/25   | 192.168.1.0/25
     | 192.168.1/24   | 192.168.1/24   | 192.168.1.128/25 | 192.168.1.128/25
     | 192.168.1.0/26 | 192.168.1.0/26 | 192.168.1.226/32 | 192.168.1.226/32
(14 rows)

SELECT '' AS ten, c AS cidr, network(c) AS "network(cidr)",
  i AS inet, network(i) AS "network(inet)" FROM INET_TBL ORDER BY c, i;
 ten |      cidr      | network(cidr)  |       inet       |  network(inet)
-----+----------------+----------------+------------------+------------------
     | 10/8           | 10/8           | 9/8              | 9/8
     | 10/8           | 10/8           | 10/8             | 10/8
     | 10/8           | 10/8           | 10/8             | 10/8
     | 10/8           | 10/8           | 11/8             | 11/8
     | 10.0.0.0/32    | 10.0.0.0/32    | 10/8             | 10/8
     | 10.1/16        | 10.1/16        | 10.1/16          | 10.1/16
     | 10.1.2/24      | 10.1.2/24      | 10.1.2/24        | 10.1.2/24
     | 10.1.2.3/32    | 10.1.2.3/32    | 10.1.2.3/32      | 10.1.2.3/32
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1/24     | 192.168.1/24
     | 192.168.1/24   | 192.168.1/24   | 192.168.1.0/25   | 192.168.1.0/25
     | 192.168.1/24   | 192.168.1/24   | 192.168.1.128/25 | 192.168.1.128/25
     | 192.168.1.0/26 | 192.168.1.0/26 | 192.168.1.226/32 | 192.168.1.226/32
(14 rows)

SELECT '' AS ten, c AS cidr, masklen(c) AS "masklen(cidr)",
  i AS inet, masklen(i) AS "masklen(inet)" FROM INET_TBL ORDER BY c, i;
 ten |      cidr      | masklen(cidr) |       inet       | masklen(inet)
-----+----------------+---------------+------------------+---------------
     | 10/8           |             8 | 9/8              |             8
     | 10/8           |             8 | 10/8             |             8
     | 10/8           |             8 | 10/8             |             8
     | 10/8           |             8 | 11/8             |             8
     | 10.0.0.0/32    |            32 | 10/8             |             8
     | 10.1/16        |            16 | 10.1/16          |            16
     | 10.1.2/24      |            24 | 10.1.2/24        |            24
     | 10.1.2.3/32    |            32 | 10.1.2.3/32      |            32
     | 192.168.1/24   |            24 | 192.168.1/24     |            24
     | 192.168.1/24   |            24 | 192.168.1/24     |            24
     | 192.168.1/24   |            24 | 192.168.1/24     |            24
     | 192.168.1/24   |            24 | 192.168.1.0/25   |            25
     | 192.168.1/24   |            24 | 192.168.1.128/25 |            25
     | 192.168.1.0/26 |            26 | 192.168.1.226/32 |            32
(14 rows)

SELECT '' AS four, c AS cidr, masklen(c) AS "masklen(cidr)",
  i AS inet, masklen(i) AS "masklen(inet)" FROM INET_TBL
  WHERE masklen(c) <= 8 ORDER BY c, i;
 four | cidr | masklen(cidr) | inet | masklen(inet)
------+------+---------------+------+---------------
      | 10/8 |             8 | 9/8  |             8
      | 10/8 |             8 | 10/8 |             8
      | 10/8 |             8 | 10/8 |             8
      | 10/8 |             8 | 11/8 |             8
(4 rows)

SELECT '' AS six, c AS cidr, i AS inet FROM INET_TBL
  WHERE c = i ORDER BY c, i;
 six |     cidr     |     inet
-----+--------------+--------------
     | 10.1.2.3/32  | 10.1.2.3/32
     | 192.168.1/24 | 192.168.1/24
(2 rows)

SELECT '' AS ten, i, c,
  i < c AS lt, i <= c AS le, i = c AS eq,
  i >= c AS ge, i > c AS gt, i <> c AS ne,
  i << c AS sb, i <<= c AS sbe,
  i >> c AS sup, i >>= c AS spe,
  i && c AS ovr
  FROM INET_TBL ORDER BY c, i;
 ten |        i         |       c        | lt | le | eq | ge | gt | ne | sb | sbe | sup | spe | ovr
-----+------------------+----------------+----+----+----+----+----+----+----+-----+-----+-----+-----
     | 9/8              | 10/8           | t  | t  | f  | f  | f  | t  | f  | f   | f   | f   | f
     | 10/8             | 10/8           | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 10/8             | 10/8           | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 11/8             | 10/8           | f  | f  | f  | t  | t  | t  | f  | f   | f   | f   | f
     | 10/8             | 10.0.0.0/32    | t  | t  | f  | f  | f  | t  | f  | f   | t   | t   | t
     | 10.1/16          | 10.1/16        | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 10.1.2/24        | 10.1.2/24      | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 10.1.2.3/32      | 10.1.2.3/32    | f  | t  | t  | t  | f  | f  | f  | t   | f   | t   | t
     | 192.168.1/24     | 192.168.1/24   | f  | t  | t  | t  | f  | f  | f  | t   | f   | t   | t
     | 192.168.1/24     | 192.168.1/24   | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 192.168.1/24     | 192.168.1/24   | f  | f  | f  | t  | t  | t  | f  | t   | f   | t   | t
     | 192.168.1.0/25   | 192.168.1/24   | f  | f  | f  | t  | t  | t  | t  | t   | f   | f   | t
     | 192.168.1.128/25 | 192.168.1/24   | f  | f  | f  | t  | t  | t  | t  | t   | f   | f   | t
     | 192.168.1.226/32 | 192.168.1.0/26 | f  | f  | f  | t  | t  | t  | f  | f   | f   | f   | f
(14 rows)

SELECT max(i) AS max, min(i) AS min FROM INET_TBL;
       max        | min
------------------+-----
 192.168.1.226/32 | 9/8
(1 row)

SELECT max(c) AS max, min(c) AS min FROM INET_TBL;
      max       | min
----------------+------
 192.168.1.0/26 | 10/8
(1 row)

-- check the conversion to/from text and set_netmask
SELECT '' AS ten, set_masklen(inet(text(i)), 24) FROM INET_TBL ORDER BY c, i;
 ten | set_masklen
-----+--------------
     | 9.1.2/24
     | 10.1.2/24
     | 10.1.2/24
     | 11.1.2/24
     | 10.1.2/24
     | 10.1.2/24
     | 10.1.2/24
     | 10.1.2/24
     | 192.168.1/24
     | 192.168.1/24
     | 192.168.1/24
     | 192.168.1/24
     | 192.168.1/24
     | 192.168.1/24
(14 rows)

SELECT * FROM inet_tbl WHERE i<<'192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(3 rows)

SELECT * FROM inet_tbl WHERE i<<='192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(3 rows)

SELECT * FROM inet_tbl WHERE i <<= '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i && '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i >>= '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 192.168.1/24 | 192.168.1/24
 192.168.1/24 | 192.168.1/24
 192.168.1/24 | 192.168.1/24
(3 rows)

SELECT * FROM inet_tbl WHERE i >> '192.168.1.0/24'::cidr ORDER BY c, i;
 c | i
---+---
(0 rows)

SELECT * FROM inet_tbl WHERE i < '192.168.1.0/24'::cidr ORDER BY c, i;
      c      |      i
-------------+-------------
 10/8        | 9/8
 10/8        | 10/8
 10/8        | 10/8
 10/8        | 11/8
 10.0.0.0/32 | 10/8
 10.1/16     | 10.1/16
 10.1.2/24   | 10.1.2/24
 10.1.2.3/32 | 10.1.2.3/32
(8 rows)

SELECT * FROM inet_tbl WHERE i <= '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 10/8         | 9/8
 10/8         | 10/8
 10/8         | 10/8
 10/8         | 11/8
 10.0.0.0/32  | 10/8
 10.1/16      | 10.1/16
 10.1.2/24    | 10.1.2/24
 10.1.2.3/32  | 10.1.2.3/32
 192.168.1/24 | 192.168.1/24
(9 rows)

SELECT * FROM inet_tbl WHERE i = '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 192.168.1/24 | 192.168.1/24
(1 row)

SELECT * FROM inet_tbl WHERE i >= '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i > '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(5 rows)

SELECT * FROM inet_tbl WHERE i <> '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 10/8           | 9/8
 10/8           | 10/8
 10/8           | 10/8
 10/8           | 11/8
 10.0.0.0/32    | 10/8
 10.1/16        | 10.1/16
 10.1.2/24      | 10.1.2/24
 10.1.2.3/32    | 10.1.2.3/32
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(13 rows)

EXPLAIN (COSTS OFF)
SELECT i FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
                 QUERY PLAN
---------------------------------------------
 Sort
   Sort Key: c, i
   ->  Foreign Scan on inet_tbl
         Filter: (i << '192.168.1/24'::inet)
(4 rows)

SELECT i FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
        i
------------------
 192.168.1.0/25
 192.168.1.128/25
 192.168.1.226/32
(3 rows)

SELECT * FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(3 rows)

SELECT * FROM inet_tbl WHERE i <<= '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i && '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i >>= '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 192.168.1/24 | 192.168.1/24
 192.168.1/24 | 192.168.1/24
 192.168.1/24 | 192.168.1/24
(3 rows)

SELECT * FROM inet_tbl WHERE i >> '192.168.1.0/24'::cidr ORDER BY c, i;
 c | i
---+---
(0 rows)

SELECT * FROM inet_tbl WHERE i < '192.168.1.0/24'::cidr ORDER BY c, i;
      c      |      i
-------------+-------------
 10/8        | 9/8
 10/8        | 10/8
 10/8        | 10/8
 10/8        | 11/8
 10.0.0.0/32 | 10/8
 10.1/16     | 10.1/16
 10.1.2/24   | 10.1.2/24
 10.1.2.3/32 | 10.1.2.3/32
(8 rows)

SELECT * FROM inet_tbl WHERE i <= '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 10/8         | 9/8
 10/8         | 10/8
 10/8         | 10/8
 10/8         | 11/8
 10.0.0.0/32  | 10/8
 10.1/16      | 10.1/16
 10.1.2/24    | 10.1.2/24
 10.1.2.3/32  | 10.1.2.3/32
 192.168.1/24 | 192.168.1/24
(9 rows)

SELECT * FROM inet_tbl WHERE i = '192.168.1.0/24'::cidr ORDER BY c, i;
      c       |      i
--------------+--------------
 192.168.1/24 | 192.168.1/24
(1 row)

SELECT * FROM inet_tbl WHERE i >= '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(6 rows)

SELECT * FROM inet_tbl WHERE i > '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(5 rows)

SELECT * FROM inet_tbl WHERE i <> '192.168.1.0/24'::cidr ORDER BY c, i;
       c        |        i
----------------+------------------
 10/8           | 9/8
 10/8           | 10/8
 10/8           | 10/8
 10/8           | 11/8
 10.0.0.0/32    | 10/8
 10.1/16        | 10.1/16
 10.1.2/24      | 10.1.2/24
 10.1.2.3/32    | 10.1.2.3/32
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1/24
 192.168.1/24   | 192.168.1.0/25
 192.168.1/24   | 192.168.1.128/25
 192.168.1.0/26 | 192.168.1.226/32
(13 rows)

EXPLAIN (COSTS OFF)
SELECT i FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
                 QUERY PLAN
---------------------------------------------
 Sort
   Sort Key: c, i
   ->  Foreign Scan on inet_tbl
         Filter: (i << '192.168.1/24'::inet)
(4 rows)

SELECT i FROM inet_tbl WHERE i << '192.168.1.0/24'::cidr ORDER BY c, i;
        i
------------------
 192.168.1.0/25
 192.168.1.128/25
 192.168.1.226/32
(3 rows)

-- simple tests of inet boolean and arithmetic operators
SELECT i, ~i AS "~i" FROM inet_tbl ORDER BY c, i;
        i         |         ~i
------------------+--------------------
 9/8              | 246/8
 10/8             | 245/8
 10/8             | 245/8
 11/8             | 244/8
 10/8             | 245/8
 10.1/16          | 245.254/16
 10.1.2/24        | 245.254.253/24
 10.1.2.3/32      | 245.254.253.252/32
 192.168.1/24     | 63.87.254/24
 192.168.1/24     | 63.87.254/24
 192.168.1/24     | 63.87.254/24
 192.168.1.0/25   | 63.87.254.128/25
 192.168.1.128/25 | 63.87.254.0/25
 192.168.1.226/32 | 63.87.254.29/32
(14 rows)

SELECT i, c, i & c AS "and" FROM inet_tbl ORDER BY c, i;
        i         |       c        |      and
------------------+----------------+----------------
 9/8              | 10/8           | 8/8
 10/8             | 10/8           | 10/8
 10/8             | 10/8           | 10/8
 11/8             | 10/8           | 10/8
 10/8             | 10.0.0.0/32    | 10.0.0.0/32
 10.1/16          | 10.1/16        | 10.1/16
 10.1.2/24        | 10.1.2/24      | 10.1.2/24
 10.1.2.3/32      | 10.1.2.3/32    | 10.1.2.3/32
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1.0/25   | 192.168.1/24   | 192.168.1.0/25
 192.168.1.128/25 | 192.168.1/24   | 192.168.1.0/25
 192.168.1.226/32 | 192.168.1.0/26 | 192.168.1.0/32
(14 rows)

SELECT i, c, i | c AS "or" FROM inet_tbl ORDER BY c, i;
        i         |       c        |        or
------------------+----------------+------------------
 9/8              | 10/8           | 11/8
 10/8             | 10/8           | 10/8
 10/8             | 10/8           | 10/8
 11/8             | 10/8           | 11/8
 10/8             | 10.0.0.0/32    | 10.1.2.3/32
 10.1/16          | 10.1/16        | 10.1/16
 10.1.2/24        | 10.1.2/24      | 10.1.2/24
 10.1.2.3/32      | 10.1.2.3/32    | 10.1.2.3/32
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1/24     | 192.168.1/24   | 192.168.1/24
 192.168.1.0/25   | 192.168.1/24   | 192.168.1.0/25
 192.168.1.128/25 | 192.168.1/24   | 192.168.1.128/25
 192.168.1.226/32 | 192.168.1.0/26 | 192.168.1.226/32
(14 rows)

SELECT i, i + 500 AS "i+500" FROM inet_tbl ORDER BY c, i;
        i         |      i+500
------------------+------------------
 9/8              | 9/8
 10/8             | 10/8
 10/8             | 10/8
 11/8             | 11/8
 10/8             | 10/8
 10.1/16          | 10.1/16
 10.1.2/24        | 10.1.3/24
 10.1.2.3/32      | 10.1.3.247/32
 192.168.1/24     | 192.168.2/24
 192.168.1/24     | 192.168.3/24
 192.168.1/24     | 192.168.3/24
 192.168.1.0/25   | 192.168.2.128/25
 192.168.1.128/25 | 192.168.3.128/25
 192.168.1.226/32 | 192.168.3.214/32
(14 rows)

SELECT i, i - 500 AS "i-500" FROM inet_tbl ORDER BY c, i;
        i         |       i-500
------------------+--------------------
 9/8              | 9/8
 10/8             | 10/8
 10/8             | 10/8
 11/8             | 11/8
 10/8             | 10/8
 10.1/16          | 10.1/16
 10.1.2/24        | 10.1.0/24
 10.1.2.3/32      | 10.1.0.15/32
 192.168.1/24     | 192.167.255/24
 192.168.1/24     | 192.167.255/24
 192.168.1/24     | 192.168.0/24
 192.168.1.0/25   | 192.167.255.0/25
 192.168.1.128/25 | 192.168.0.0/25
 192.168.1.226/32 | 192.167.255.238/32
(14 rows)

SELECT i, c, i - c AS "minus" FROM inet_tbl ORDER BY c, i;
        i         |       c        |   minus
------------------+----------------+-----------
 9/8              | 10/8           | -16711165
 10/8             | 10/8           |     66051
 10/8             | 10/8           |     66051
 11/8             | 10/8           |  16843267
 10/8             | 10.0.0.0/32    |     66051
 10.1/16          | 10.1/16        |       515
 10.1.2/24        | 10.1.2/24      |         3
 10.1.2.3/32      | 10.1.2.3/32    |         0
 192.168.1/24     | 192.168.1/24   |         0
 192.168.1/24     | 192.168.1/24   |       226
 192.168.1/24     | 192.168.1/24   |       255
 192.168.1.0/25   | 192.168.1/24   |         0
 192.168.1.128/25 | 192.168.1/24   |       255
 192.168.1.226/32 | 192.168.1.0/26 |       226
(14 rows)

SELECT '127.0.0.1'::inet + 257;
   ?column?
--------------
 127.0.1.2/32
(1 row)

SELECT ('127.0.0.1'::inet + 257) - 257;
   ?column?
--------------
 127.0.0.1/32
(1 row)

SELECT '127.0.0.2'::inet  - ('127.0.0.2'::inet + 500);
 ?column?
----------
     -500
(1 row)

SELECT '127.0.0.2'::inet  - ('127.0.0.2'::inet - 500);
 ?column?
----------
      500
(1 row)

-- these should give overflow errors:
SELECT '127.0.0.1'::inet + 10000000000;
ERROR:  result is out of range
SELECT '127.0.0.1'::inet - 10000000000;
ERROR:  result is out of range
DROP TABLE INET_TBL;
